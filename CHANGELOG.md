## Bug Fixes
* 修复macOS下窗口无法全屏的问题。
* 修复在Input内输入Enter按键时，会触发两次update事件的问题。
* 修复当程序打开时，主页没有进入loading屏，而是会残留显示上一次的内容的问题。
* 补充了在分区详情页的图像列表被遗漏的快捷排序菜单。
* 修复了当删除图像项目时，其所属的集合的属性没有被重新导出的问题。
* 修复了当清除图像或集合项目的已有标签后，其并不能正确地从属性推导中获得新标签的问题。
## Features
* 在图像预览弹窗添加了左右导航按钮。
## Optimizes
* 修改了macOS的构建流程，现在plist的版本号可以从client的版本号生成。
* 修改了macOS下显示在菜单栏的App名称，去掉了"v3"字样。
* 调整了macOS下的UI，取消了系统原生的窗口顶栏，使用App内部top bar作为顶栏。

# v0.4.1
## Bug Fixes
* 修复HQL查询中的bookMember过滤器对集合无效的问题。
* 更新了属性克隆的策略，现在对于score/description/favorite这些属性，merge也将对其有效，已有的值不会被空值覆盖。
* 修复分区的图像列表页中，collectionMode切换无效的问题。
* 修复相似项查找-相似关系图中，macOS的command按键无法在选择中正确生效的问题。同时，调整区分了CTRL和SHIFT的行为，使得SHIFT不再会取消选择。
* 修复相似项查找-相似关系图中，如果没有访问过列表模式，则右侧侧边栏的预览功能不可用的问题。与此同时，也调整了该模式下右侧侧边栏预览功能的逻辑，现在它不再会在单选时造成导航了。
* 修复相似项查找-相似项列表中，右键菜单预览功能不可用的问题，以及补充了空格键触发的预览功能。
* 修复标签列表右键菜单的“在画集中搜索”功能无效的问题。
## Optimizes
* 对首页做了优化。
  - 优化了内容生成逻辑，修掉了一些不合理的条件设定，使现在的内容生成更加合理。
  - 现在首页内容将在程序启动时生成，而不是首次访问首页时。在fastboot等状态下这会使首屏加载更快。
  - 首页的主题、作者、最近倒入、历史时间线等位置的图像列表调整为项目列表，也就是包含了集合/图像。这使得这些地方不至于被单个集合的图像占领。
* 主题、作者详情页的示例列表也调整为项目列表。这使得这些地方不至于被单个集合的图像占领。
* 侧边栏-多选操作：“设置时间分区”、“设置排序时间”按钮，现在完全变成下拉菜单，将原本的点按做成了下拉菜单的一个项，并且微调了一些项的顺序和名称。
* 图像列表、集合详情页的右键菜单新增了“快捷排序”，可以从这里执行一部分批量排序功能。

# v0.4.0
## Bug Fixes
* 修复当创建的集合的图像有favorite标记时，集合可能不会被favorite标记的问题。该问题是集合创建时的favorite计算方法和别处未统一导致的。
* 修复当使用批量操作为项目添加元数据标签时，Tagme总是会被清空的问题。
* 修复集合的description不会被正确导出给它的子项的问题。该问题是集合更改时无法发出description更改事件导致的。
* 修复时间分区-时间线，在浅色模式下，背景色样式会出现两层分层的问题。该问题是遮罩层与反遮罩层的布局位置错误导致的。
* 修复主页-画集推荐中fav图标未与实际属性挂钩的问题，并更新了图标的样式。
* 修复Home、End、PageUp、PageDown按键仍能在对话框弹出时控制下层的列表滚动的问题。
* 在图像列表-侧边栏-来源数据面板新增了单独的编辑按钮，以避免在没有任何数据时无法通过双击进入编辑器的情况。
## Features
* “导入项目”功能已重新设计。
  - 现在，向图库内添加文件时，文件会生成“导入记录”，并在准备完毕后立刻导入图库，不再有等待二次导入的过程。
  - 导入记录相比之前，更接近于一个文件导入的备用记录，记忆近期导入的文件的原始信息，并在必要时重新生成需要的来源、时间信息。
  - 导入记录不是持久可靠的：任何已准备完成的记录都会在程序退出后被清除。被清除的旧记录依然可以在“查看历史记录”功能查阅，但不可恢复，且会在数量达到上限或超出时间期限后被彻底清理。
  - 导入记录列表的功能更加轻量化，由于它不再具备“导入前的编辑区域”功能定位，很多复杂的操作都已被移除，如有类似需要，则使用最近导入的图库/时间分区完成近似操作。
* “相似项查找”功能已更新。
  - 相似项查找的各类模型和枚举已重新精简设计。
  - 相似项查找中的graph结构发生了变化。类似集合、画集、来源集合这类1toN结构现在独立出来了，成为了graph中的一个独立的点，而不是交织在它所有关联项的关系之间。这有助于在复杂结构中理清各类所属关系。
  - 相似项查找的filter选项与find选项都有更新。“来源相同“、”来源相近“现在被拆分成了的两个选项；”根据来源集合”、“根据来源关联项“等方式现在也支持作为filter选项了；现在支持将selector列表作为filter选项了。
  - 前端处理相似项结果的详情页已完全重制。旧的AB选择器+CompareTable的方式已被移除，现已替换为“图像列表”、“graph结构图”、“对比表”三种可切换的视图。同时也添加了与标准图像列表一致的侧栏，可以在相似项结果中对图像的其他元数据做更改了。
  - 结果处理模式已更新。现在每一步结果处理都实时反映到数据库中，而不是选择完所有操作后一次性应用。现在也可以实时获知结果是否已完全处理了，当完全处理后右上角的完成按钮会亮起提醒。
  - 在图像列表、标签作者列表添加了快捷进行相似项查找的右键菜单选项。
* 时间分区-时间线新增了右键菜单「复制日期列表」与「将日期列表添加到查询条件」的功能。
* 来源标签列表(展示模式)新增了右键菜单「复制标识编码」「复制显示名称」的功能。
* 图像列表、时间分区等位置的collectionMode按钮得到了扩展，现在额外支持了「仅所有集合」「仅无集合图像」两种显示模式。
## Optimizes
* 视频播放器的底部响应区域加高了一些，进度条高度也增加了一些，更利于选中。
* 视频播放器的前进/倒退快捷键由CTRL+L/R更改为L/R，更符合一般使用直觉。
* Tag的标签树现在会暂时记住它的折叠状态，在窗口内的所有TagTree处共享状态，直到刷新或窗口关闭。
* 搜索框的样式优化，现在文本不会再出现在按钮的后方，造成遮挡。

# v0.3.2
## Bug Fixes
* 修复在暂存区移除项目时，仅移除当前所指项而不是所有选择项的问题。
* 设置-导入-来源数据解析规则，额外信息-标签的标签类型输入框已纠正为选择框。
## Features
* 为集合增加了关联的画集和目录，可以在集合的相关项目侧边栏确认到。实质上是集合下属的图像的关联画集和目录。
* 增加了集合和图像之间收藏状态的联动。现在集合的收藏状态跟时间属性一样，视作图像的收藏状态的代理属性。任一图像标记为收藏就会使集合标记为收藏；集合的标记与取消会影响全部图像。
* 图像列表-侧边栏-多选面板新增了新的排序选项，支持将partitionTime或orderTime集中在分布最多的那天。
## Optimizes
* 在图像列表、集合详情页、时间分区等处通过拖放修改排序时间的功能已更改为后端实现，这改善了某些极端情况下的表现：插入在一个集合后时，现在将集合内的最后时间点而不是开始时间点作为端点，从而防止插入项入侵到集合区间内。此外，现在根据查询条件推断排序顺序，从而避免项数过少或连续多项的排序相同造成无法推断排序顺序的问题。

# v0.3.1
## Bug Fixes
* 修复时间分区-时间线，在查询条件变化时，显示结果保持不变的问题。
* 修复在集合详情页修改集合信息时，会导致集合图像列表重新加载的问题。
* 修复各类虚拟滚动列表高度计算不正确的问题。之前调整了全局div的box-sizing，这造成了虚拟列表的实际高度错误。
## Features
* 在集合详情页的图像列表也支持拖放更改排序时间了。不过仅限于内部移动，从外部向集合内添加新项并不会造成重排序。
* 在暂存区弹窗的图像列表已支持向外拖曳。
* 已支持修改集合的时间分区和排序时间。这两项属性的更改将直接更改下属图像的对应属性。
* 在图像/集合的详情侧边栏添加了一个有关属性推导的提示，当评分、描述、标签是推导获得的时，在后面显示一个EXPORTED小标记。
## Optimizes
* 调整了相似项查找中信息缓存的实现方式，将illust/importImage的数据以每条为单位缓存；调整了来源相同项的查找逻辑，使其对全库执行扫描。以上优化大幅提升了相似项查找效率，使耗时下降85%左右。
* 更换了后端日志库，并调整了日志的输出格式。

# v0.3.0
## Bug Fixes
* 修复导入文件-预设来源数据-来源标签无法被正确设置的问题。
* 修复暂存区弹窗中任意位置点击会导致弹窗关闭的问题。
* 修复文档切换页面时不会重置滚动条的问题。
* 修复侧边栏的tab按钮占据的宽度不能正确变化的问题。
* 修复时间分区-时间线，在所选月份变化时，没有正确追踪月份列表的项的问题。
* 使用Locate功能定位时，如果列表处于COLLECTION模式下且目标图像属于集合，将转而查找目标图像所在的集合。由此可避免在COLLECTION模式下无法定位/定位错误的问题。
## Features
* 新增"便签"功能，允许记录一些笔记与待办事项。
* 导入规则的extra rule新增"将下划线转换为空格"选项。
* 在时间分区列表新增快捷键CTRL+R用于刷新列表。
## Optimizes
* 在各类图像列表、导入项目列表的右键菜单，重命名了一些菜单项，添加了"预览"功能，将"标记为收藏"调整为checkbox。在导入列表的菜单还添加了一些批量处理功能。
* 优化了在图像列表、时间分区通过拖放修改排序时间的功能表现。1. 现在不再在前端去除begin和end端点，而是在后端完成，优化了端点排布，防止在过窄时中间值挤不下、首尾两项紧贴端点造成后续操作不便的状况；2. 当begin和end相距过远时不再无脑使用两端点计算中间值，而是贴近其中一端(离现有项较近的一端)逐秒排列，防止在这种长跨度中将间隔拉得过长。

# v0.2.1
## Bug Fixes
* 修复在导入列表中，当缩略图已准备完毕时，前端不会自动刷新的问题。
* 修复了当图库列表持有查询条件时，从别的地方点击定位某个图像时，会因为保留了旧查询条件而无法定位目标的问题。现在定位图像时，会清除旧的查询条件。
## Optimizes
* 调整了时间分区页面的组件，懒加载分区列表页面，以减少在分区列表/分区详情间切换时造成列表页滚动位置异常的情况。
* 调整了时间分区-日历的样式，在dark mode下采取了不同的颜色策略，始终保持亮色文字不随背景色变化而翻转。
* 重写了时间分区-时间线的CSS，在dark mode下使用了不同的样式实现，保持相同效果的同时降低复杂度。
* 在时间分区-时间线新增了日期列表的选中效果，将选中当前月份的所有日期，以突出显示关注点，防止在长列表中找不到目标。

# v0.2.0
## Bug Fixes
* 修复了在输入框的输入法状态下按下退格键时，会意外触发视图的回退的问题。
* 修复了"新建相似项查找"对话框中部分复选框选项无效的问题，以及"其他导入项目"类别的查找范围有时不生效的问题。
* 修复"相似项查找"结果页面中，"加入画集"在多选模式下不显示预设画集列表的问题。
* 修复"相似项查找"结果页面中的部分文本错误。
* 修复了"在新窗口打开"的集合页面时，无法使用预览弹窗的问题。
* 修复了ImageViewStack的当前项变化时，父级列表的选中项未随着一起变化的问题。
* 全局屏蔽了一部分快捷键的默认行为，以阻止这些快捷键在滚动列表中造成滚动效果，尤其是在一些情况下滚动列表并未聚焦但仍可被滚动。
## Features
* 图像列表的侧边栏调整为tab选项卡模式，并支持通过选项卡切换查看与图像详情页的侧边栏相同的内容。
* 图像列表侧边栏的"相关内容"选项卡中，添加了画集的预览横幅。
* 图像列表的侧边栏的多选操作面板已重新设计，优化了UI，减少了操作步骤，且增加了多种排序相关的菜单项。
* 导入列表的侧边栏也已重新设计，与图像列表的改变相同，其多选操作面板也增加了多种排序相关的菜单项。
* 画集列表也增加了侧边栏显示信息，并且调整为单击选中、双击打开的模式，与图像列表一致。
* 对Score组件的样式做了调整，现已支持点击直接设置对应数值，且在边栏不再需要双击进入编辑模式了，可以直接点击设置值。
* "作者"的类型调整为"画师"、"社团"、"系列作品"。
* 来源标签的列表和编辑器调整为按照类型分组显示。
* 在设置-核心服务，支持直接查看核心服务日志与重启核心服务。
* 在图像列表、其他各类虚拟滚动列表新增快捷键CTRL+R用于刷新列表。
* 在图像列表、导入项目列表新增快捷键快捷SPACE用于打开/关闭预览窗口。
* 在图像列表、时间分区、画集列表、来源数据列表，现在可以记忆查询内容，切换页面不会重置内容。其中图像列表和时间分区将共享相同的查询条件。
* 在图像列表、时间分区，现在也支持拖放功能了。实际作用是快捷更改排序时间，达成更改顺序的效果。
## Optimizes
* 已在边栏的大多数Input组件中支持按Enter直接提交编辑，以及在双击进入编辑模式时获得焦点。
* "在新窗口打开"的页面，现在默认关闭侧边栏。
* "在新窗口打开"的页面导航方式已调整为query参数，同时也修复了重新加载后页面空白的问题。
* 已可以记录窗口上次打开的位置和状态，下次打开同类窗口时将恢复上次的状态。
* 重新加载的快捷键已更改为CTRL+SHIFT+R，以避免与列表刷新的快捷键冲突。
* 在ImageViewStack中，现在可以循环导航了(可以从第一项后退一位去到最后一项，或者反过来)。
* 时间分区的"时间线"、"日历"已重构，解决了之前的诸多易用性问题和细碎的bug，并新增了渐变颜色样式以直观地了解每个日期的项数。

# v0.1.5
## Bug Fixes
* 替换了后端dao层的date类字段使用的字段实现，改用了时区无关的实现，避免时区切换时可能的时间错乱。
## Optimizes
* 在图像列表右键"创建图像集合"时，若所有图像都不属于任何集合，那么对话框默认不会再打开，而是直接创建集合。
* 在图像列表右键"创建画集"对话框中做了一些易用性优化。现在直接聚焦title文本框，可以在文本框中按下ESC了，可以在title文本框按下Enter以直接创建。
* 修改了集合的排序/分区时间选取逻辑。现在选取数量最多的分区时间，以及这个分区里最小的排序时间。
* 修改了向画集添加新图像时的排序逻辑。现在新图像总是按照排序时间排序，然后再插入指定位置。
* 调整了图像列表的"收藏"和"视频"图标效果，使其在同色背景下更易分辨。
* 调整了缩略图生成时透明背景填充的颜色，从黑色更改为极浅的灰色。
* 调整了执行二次导入的代码结构，优化大量文件确认导入时的执行速度。
* 将FileCacheRecord表移动到system分库，以隔离存储数据和使用数据。

# v0.1.4
## Bug Fixes
* 在FileManager模块探查到了一个仍无法解决的bug。该bug的成因可能是SQL插入语句的返回值并不是该插入项的主键，且此问题极难复现。  
  目前仅是通过问题现象做出了以上成因推断，且为何出现完全未知，也无法得知是SQLite、Ktorm的问题还是存在意料之外的代码疏忽。  
  该问题会造成记录丢失，且有概率造成文件丢失。已添加插入语句后的ID检查，以尽量避免此问题。
* 修复SimilarFinder.RecordBuilder模块在新记录生成时，节点数量过多会导致栈溢出的问题。
* 修复对列表的项进行大量删除、更新操作时，有概率出现错位/已删除项残留/显示错误的问题。
* 修复写入大小写不同的code的来源标签/来源集合时，因程序处理不一致引起的错误。
* 修复缩略图生成模块的分辨率识别算法的一个问题。面对个别图片时，分辨率算法无法正确识别格式并抛出了异常。现已补充发生异常时的回退算法。
* 修复部分位置的缩略图分辨率宽高数值写反的问题。
* 修复画集内容页的图像列表无法显示的问题。
* 修复导入-来源数据解析规则-页名/分页页名留空时没有被判定为空项而是被当作空串的问题。
## Features
* 调整了来源标签的唯一定位方式。现在由(site, type, code)唯一定位一个标签。与之对应的，type不再能为空，相关API与UI都有所调整。
* 来源标签的type更改为仅能从已配置的列表中选取。
* 来源收集状态API现已支持查询相同part name的分页在不同id下的收集情况。
* HQL查询的Illust查询已支持通过source part和source part name筛选，并已支持使用site和type限定查询source tag。
## Optimizes
* 更换图像处理使用的库，以改善稳定性和Bug问题。同时略微优化了缩略图和图像指纹生成的流程。

# v0.1.3
## Bug Fixes
* 修复了一个png图像读取问题。该问题曾导致部分png图像BufferedImage.type无法正确读取，从而导致后续处理错误。
* 修复指纹生成模块未使用正确算法读取图片导致的问题。
* 修复部分对话框无高度的问题。
* 修复批量编辑标签时，重新选择标签按钮无效的问题。
* 修复导入列表文件数量从0到有时，导航栏数字显示Infinty的问题。
* 替换了后端所使用的时间类型，使用了更合理的Instant类型，避免时区切换时可能的时间错乱。
* 修复了HQL查询中的时间筛选未按照用户时区进行的问题。
* 修复了当来源数据由文件导入自动生成时，Links不会按规则自动生成的问题。
## Optimizes
* 图库网格视图中，图像示意图(sample)/缩略图(thumbnail)的切换现在根据实际列宽来决定。
* 可以通过拖曳来锁定或关闭通知(Toast)了。同时也修复了最后一个通知关闭时的错误动画。

# v0.1.2
## Bug Fixes
* 修复了一个模块打包问题。该问题曾导致jave模块不可用，从而导致处理视频文件时报错失败。
* 修复了一个jpeg图像转码问题。该问题曾导致部分具有透明度的gif图像无法生成缩略图。
* 修复了一个jpeg图像读取问题。该问题导致部分jpeg图像在读入时无法正确处理颜色，从而输出颜色混乱的缩略图。
* 修复了某些图像的缩略图所选择的实际图像不正确的问题。
* 更新了Electron，修复了一个渲染问题。该问题曾导致某些情况下img图像出现错误渲染。
* 修复了"导入"选项中"分区判定时间段"无法设置的问题。
* 修复了文件跨硬盘移动时失败的问题。
* 修复了一个拖曳导入问题。该问题曾导致将文件拖曳到现有项目上导入时，会双倍导入。
* 修复了一个内部文件归档问题。该问题的出现条件较为复杂，但不是不可能出现。  
    1. 删除一个未归档的Block中的所有文件，会使该Block的directory留在原地。
    2. 下次启动时，FileGenerator模块认定latestBlock是上一个Block(或者当没有文件时是null)，且该Block的directory的存在使得模块认为应该执行对该Block的归档。
    3. 在归档开始之前，仍有时间添加文件，此时新添加的文件会添加到该Block，且在归档开始时将这些文件归档为zip，即使此Block没有满(或者说，与满不满根本无关)；
    4. 并且，由于FileManager模块未受影响，下一个文件仍然继续添加到该模块，导致出现latestBlock区块directory与zip同时存在的奇观。
    5. 主要问题来自FileGenerator对哪些Block需要归档划分不清，因此需要精细处理边界条件，使latestBlock默认值为1，且条件改为小于。
* 修复了"相似项查找页面"-列表的示意图显示区域，当示意图过多开始滚动时，整体布局失控的问题。
* 修复了"添加到集合对话框"-已存在集合的示意图列表，排列方向错误的问题。
* 修复了向导入列表大量添加文件时，有概率出现文件重复/错位显示的问题。
* 修复了删除导入列表的所有文件时，导航栏数字不清零的问题。
* 修复了"导出"功能非打包导出不可用的问题。
## Features
* 添加了一个用于快速查询指定来源数据是否已收集的API，用于协助Chrome Extension工作。
* 添加了固定Token的选项，用于协助Chrome Extension工作。
* 添加了暂存区双击/回车打开详情页的功能，且支持在暂存区内任意拖放以添加图像、改变图像排列。
## Optimizes
* 调整了文件归档和磁盘删除逻辑。现在删除文件不会稍后触发磁盘删除，所有的磁盘删除行为都仅在后端启动时发生。
* 调整了项目/来源数据的标题/描述条目的字号，且描述条目现在有最大高度、可滚动、可正确显示空行。
* 首页不再显示没有内容的栏目。所有的栏目都没有内容时，添加了一个欢迎屏幕。
* 调整部分对话框的高度为内容自适应高度。
* 修改默认字体为"Noto sans"。

# v0.1.1
## Bug Fixes
* 修复了后端事件总线在大量事件冲击时崩溃的问题。
* 修复了一个HQL查询中date类型的问题。该问题曾导致当使用诸如yyyy-MM-dd的单值日期时，查询匹配将只匹配该日期的00:00:00时间点，从而导致匹配不到预期中的任何项。
* 修复了一个属性推导时的问题。该问题曾导致当Collection需要从子项拷贝全部标签时，如果子项存在之前从Collection拷贝的标签，那Collection仍旧会拷贝这些旧标签。
## Features
* 添加向导页面，包括文档内容。
## Optimizes
* 缩略图/指纹生成的后台任务现在使用多线程并发处理，大幅提高处理速度。
* 在图库网格视图的列数大于8时，网格中的图像显示示意图(sample)。
* 版本号引用方式更新：Client在现在从gradle读取server的最新版本号，而不需要手动填写。